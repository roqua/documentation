general:
  branches:
    ignore:
      - gh-pages
machine:
  ruby:
    version: 2.3.1
dependencies:
  pre:
    - git config user.email "circleci@roqua.nl"
    - git config user.name "CircleCI"

test:
  override:
    - bundle exec rake test
    - bundle exec rake validate:links:internal
deployment:
  production:
    branch: master
    commands:
      - bundle update roqua-rom-api && export DOC_DIR=`pwd` && cd `bundle show roqua-rom-api` && yardoc --output-dir $DOC_DIR/content/rom_api_gem
      - bundle exec rake publish
